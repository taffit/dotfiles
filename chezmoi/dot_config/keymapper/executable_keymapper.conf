# https://github.com/houmain/keymapper
# Example: https://github.com/houmain/keymapper/blob/main/keymapper.conf
# Power user conf: https://github.com/ristomatti/keymapper-config/blob/main/keymapper.conf
# Other inspiration: https://github.com/kbilsted/kbg_config/blob/master/kbgstuff/keymapper-4.9.1-win64/keymapper.conf

# Configuration
@forward-modifiers Control Meta Shift Alt AltRight
@allow-unmapped-commands
@enforce-lowercase-commands
@toggle-active Escape{K} # This combination doesn't seem to work
# Shift-Escape K closes the daemon keymapperd

# include-optional doesn't fail if the file doesn't exist
@include "include/key_aliases.conf"
@include-optional "include/local.conf" # Defines local variables and paths
# @include "include/key_sequences.conf"
@include "include/text_expansion.conf"

# Possible values for context: title (w regex //i), system, class, device, path, modifier
[default]
# home row mod
# A{200ms Any} >> Win{Any}
# S{200ms Any} >> AltLeft{Any}
A{200ms Any} >> Shift{Any}
(A S){200ms Any} >> AltLeft{Any} ^
# F{200ms Any} >> Control{Any}
# J{200ms Any} >> Control{Any}
# K{200ms Any} >> Shift{Any}
Semicolon{200ms Any} >> Shift{Any}
(Semicolon L){200ms Any} >> AltRight{Any} ^
# Semicolon{200ms Any} >> Win{Any}

delete_last_word = (Control Shift){ArrowLeft} Backspace ^
(S D){!160ms} >> delete_last_word
delete_next_word = (Control Shift){ArrowRight} Delete ^
(D F){!160ms} >> delete_next_word
(S F) >> Delete
(A F) >> Backspace
(J K) >> Escape
(F G) >> "("
(R T) >> "["
(C V) >> "{"
(U I) >> "]"
(H J) >> ")"
(N M) >> "}"
switch_input = $("${controlMyMonitor_path}" /SetValue "EB275U" 60 $0) ^
switch_hdmi1 = switch_input[17]
switch_hdmi2 = switch_input[18]
switch_hdmi3 = switch_input[19]
switch_dp = switch_input[15]
run_script = $("${scripts_path}/$0.exe") ^
paste_plain = run_script["paste_plain"]
test_script = run_script["hello"]

# define a virtual "boss" key, which can be toggled using the scroll-lock key
# when the boss key is "pressed", the keyboard behaves as a normal keyboard
# `Virtual` means: an unused virtual key
Boss = Virtual
# The virtual state is toggled (see: @virtual-keys-toggle (default: true))
ScrollLock >> Boss
Boss{Any} >> Any

# Inspired by: https://youtu.be/rvM2BthjEI4?si=qvojW3_7J21CNYqD&t=538
(J K L){!120ms} >> Enter ^

# esc instead of caps lock, using an additional modifier
AltRight{CapsLock} >> CapsLock ^
Ext = CapsLock
CapsLock           >> Escape ^

# define an additional modifier "Ext" (angular bracket key on some keyboards)

# Navigation
Ext{H} >> NavLeft #ArrowLeft
Ext{J} >> NavDown #ArrowDown
Ext{K} >> NavUp #ArrowUp
Ext{L} >> NavRight #ArrowRight
Ext{Y} >> Home
Ext{U} >> Control{ArrowLeft}
Ext{I} >> Control{ArrowRight}
Ext{O} >> End
# Media control
Ext{N} >> AudioVolumeDown
Ext{M} >> AudioVolumeUp
Ext{Space} >> MediaPlayPause
# Windows
Ext{Tab} >> Meta{Tab}
# Other Capslock goodies
(Ext Shift){Z}       >> Control{Y}
Ext{Backspace}       >> Delete
Ext{V}               >> paste_plain
Win{V}               >> paste_plain
Ext{Q}               >> test_script
Ext{Period} >> "Â·"
# Mostlyds Control
Ext{S}				 >> Control{S}
Ext{X}               >> Control{X}
Ext{C}               >> Control{C}
Ext{Z}               >> Control{Z}
Ext{W}				 >> Control{W}
Ext{R}               >> Control{R}
Ext{Enter}           >> Control{Enter}

# the Ext modifier together with other keys should have no effect
Ext{Any} >>

# Switch input at monitor
Backquote{1} >> switch_hdmi1
Backquote{2} >> switch_hdmi2
Backquote{3} >> switch_hdmi3
Backquote{4} >> switch_dp

# See "Key group aliases" for definition of Alpha and Digit
CapsWordKeys = Alpha | Digit | Backspace | Delete
CapsWord = Virtual
? (ShiftLeft ShiftRight) >> CapsWord
(W R)                    >> CapsWord
# CapsWord                 >> CapsLock ^ CapsLock

[modifier = "CapsWord"]
Alpha       >> Shift{Alpha}
CapsWordKeys >> CapsWordKeys
Symbol >> !CapsWord Symbol ^
Whitespace >> !CapsWord Whitespace ^
Esc >> !CapsWord
